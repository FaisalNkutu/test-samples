<?xml version = '1.0' encoding = 'UTF-8'?>
<Module version="122010400" xmlns="http://xmlns.oracle.com/Forms">
   <FormModule Name="LOGON" DirtyInfo="true" Title="ADAM Logon" FirstNavigationBlockName="LOGON_BLOCK" ConsoleWindow="LOGON_WINDOW" MenuModule="">
      <Coordinate CharacterCellWidth="9" RealUnit="Pixel" DefaultFontScaling="false" CharacterCellHeight="19" CoordinateSystem="Real"/>
      <Alert Name="STOP_ALERT" DirtyInfo="true" Button1Label="Exit" Button2Label=""/>
      <Alert Name="PW_ALERT" DirtyInfo="true" Button1Label="YES" Button2Label="NO"/>
      <AttachedLibrary Name="D2KWUTIL" LibraryLocation="D2kwutil" LibrarySource="File"/>
      <Block Name="LOGON_BLOCK" DirtyInfo="true" ScrollbarWidth="19" ScrollbarLength="180">
         <Item Name="USERNAME" XPosition="180" YPosition="116" DirtyInfo="true" TabPageName="" Width="151" CanvasName="LOGON_CANVAS" CaseRestriction="Upper" Height="22">
            <Trigger Name="KEY-NEXT-ITEM" DirtyInfo="true" TriggerText="BEGIN          &amp;#10;DECLARE&amp;#10;&#x9;FIND_SLASH NUMBER;&amp;#10;&#x9;FIND_AT NUMBER;&amp;#10;&#x9;PATH VARCHAR2(255);&amp;#10;BEGIN&amp;#10;&#x9;FIND_AT := INSTR(:LOGON_BLOCK.USERNAME, '@');&amp;#10;&#x9;FIND_SLASH := INSTR(:LOGON_BLOCK.USERNAME, '/');&amp;#10;&amp;#10;IF FIND_AT > 0 THEN&amp;#10;  :LOGON_BLOCK.CONNECT := SUBSTR(:LOGON_BLOCK.USERNAME, FIND_AT + 1, 30);&amp;#10;  :LOGON_BLOCK.PASSWORD := SUBSTR(:LOGON_BLOCK.USERNAME, FIND_SLASH +1, FIND_AT - FIND_SLASH - 1);&amp;#10; &#x9;:LOGON_BLOCK.USERNAME := SUBSTR(:LOGON_BLOCK.USERNAME, 1, FIND_SLASH -1);&amp;#10;  GOTO CONNECTING;&amp;#10;ELSIF FIND_SLASH > 0 THEN&amp;#10;  :LOGON_BLOCK.PASSWORD := SUBSTR(:LOGON_BLOCK.USERNAME, FIND_SLASH +1, 30);&amp;#10; &#x9;:LOGON_BLOCK.USERNAME := SUBSTR(:LOGON_BLOCK.USERNAME, 1, FIND_SLASH -1);&amp;#10;  TOOL_ENV.GETVAR('APPDATA',path);&amp;#10;  if instr(path,'Document') > 0 then&amp;#10;   &#x9;:LOGON_BLOCK.CONNECT := WIN_API_ENVIRONMENT.READ_INI_FILE(:GLOBAL.ADAM_PATH||'\COMMANDS\ADAM.INI','ADAM','BASENAME',FALSE); &amp;#10;  else&amp;#10;   &#x9;:LOGON_BLOCK.CONNECT := WIN_API_ENVIRONMENT.READ_INI_FILE(:GLOBAL.ADAM_PATH||'\CONFIG\ADAM.INI','ADAM','BASENAME',FALSE); &amp;#10;  end if;&amp;#10;  GOTO CONNECTING;&amp;#10;ELSE&amp;#10;  GOTO SKIP;&amp;#10;END IF;&amp;#10;&amp;#10;&amp;#10;&lt;&lt;CONNECTING>>&amp;#10;&amp;#10;&#x9;IF connect_to THEN             &amp;#10;&#x9;&#x9;leave(TRUE);          &amp;#10;&#x9;END IF;          &amp;#10;--&#x9;:global.logon_tries := TO_NUMBER(:global.logon_tries) - 1;          &amp;#10;--&#x9;IF TO_NUMBER(:global.logon_tries) = '0' THEN             &amp;#10;&#x9;&#x9;leave(FALSE);          &amp;#10;--&#x9;END IF;       &amp;#10;&lt;&lt;SKIP>>&amp;#10;  NEXT_ITEM;&amp;#10;END; &amp;#10;END;"/>
         </Item>
         <Item Name="PASSWORD" XPosition="180" YPosition="157" DirtyInfo="true" TabPageName="" Width="151" CanvasName="LOGON_CANVAS" CaseRestriction="Upper" Height="22" ConcealData="true"/>
         <Item Name="CONNECT" Prompt="Database&amp;#10;Base de donnÃ©es" TabPageName="" PromptAttachmentOffset="14" ListStyle="Combo Box" PromptAlignOffset="-8" PromptFontSize="1000" Width="151" ItemType="List Item" XPosition="180" YPosition="194" DirtyInfo="true" PromptFontName="Tahoma" PromptFontStyle="Plain" CanvasName="LOGON_CANVAS" PromptFontWeight="Demilight" ListElementCount="21" PromptFontSpacing="Normal" CaseRestriction="Upper" Height="22">
            <ListItemElement Index="1" Name="Bagotville" Value="BAGOTVILLE"/>
            <ListItemElement Index="2" Name="Borden" Value="BORDEN"/>
            <ListItemElement Index="3" Name="Calgary" Value="CALGARY"/>
            <ListItemElement Index="4" Name="Cold Lake" Value="COLDLAKE"/>
            <ListItemElement Index="5" Name="Comox" Value="COMOX"/>
            <ListItemElement Index="6" Name="Edmonton" Value="EDMONTON"/>
            <ListItemElement Index="7" Name="Gagetown" Value="GAGETOWN"/>
            <ListItemElement Index="8" Name="Goose Bay" Value="GOOSEBAY"/>
            <ListItemElement Index="9" Name="Greenwood" Value="GREENWOOD"/>
            <ListItemElement Index="10" Name="Montreal/St Hubert" Value="MONTREAL"/>
            <ListItemElement Index="11" Name="Moose Jaw" Value="MOOSEJAW"/>
            <ListItemElement Index="12" Name="Pat Bay/Esquimalt" Value="PATBAY"/>
            <ListItemElement Index="13" Name="Petawawa" Value="PETAWAWA"/>
            <ListItemElement Index="14" Name="Shearwater" Value="SHEARWATER"/>
            <ListItemElement Index="15" Name="Standard" Value="STANDARD"/>
            <ListItemElement Index="16" Name="Trenton" Value="TRENTON"/>
            <ListItemElement Index="17" Name="Valcartier" Value="VALCARTIER"/>
            <ListItemElement Index="18" Name="Winnipeg" Value="WINNIPEG"/>
            <ListItemElement Index="19" Name="Yellowknife" Value="YELLOWKNIFE"/>
            <ListItemElement Index="20" Name="Repository" Value="REPOSITORY"/>
            <ListItemElement Index="21" Name="Training" Value="TRAINING"/>
            <Trigger Name="KEY-NEXT-ITEM" DirtyInfo="true" TriggerText="IF INSTR(:LOGON_BLOCK.USERNAME, '/') = 0 THEN&amp;#10;  IF :LOGON_BLOCK.PASSWORD IS NULL THEN&amp;#10;&#x9;  MESSAGE('Password must be entered.', ACKNOWLEDGE);&amp;#10;    SYNCHRONIZE;&amp;#10;&#x9;  MESSAGE('Password must be entered.', NO_ACKNOWLEDGE);&amp;#10;&#x9;  RAISE FORM_TRIGGER_FAILURE;&amp;#10;  END IF;&amp;#10;END IF;&amp;#10;&amp;#10;&#x9;IF connect_to THEN             &amp;#10;&#x9;&#x9;leave(TRUE);          &amp;#10;&#x9;ELSE&amp;#10;&#x9;&#x9;leave(FALSE);          &amp;#10;&#x9;END IF;          &amp;#10;--&#x9;:global.logon_tries := TO_NUMBER(:global.logon_tries) - 1;          &amp;#10;--&#x9;IF TO_NUMBER(:global.logon_tries) = '0' THEN             &amp;#10;--&#x9;END IF;&amp;#10;"/>
         </Item>
         <Item Name="LOGON" TabPageName="" Width="122" ItemType="Push Button" BackColor="gray32" XPosition="69" FontName="Segoe UI" YPosition="247" FontSize="900" FontStyle="Plain" DirtyInfo="true" FontWeight="Bold" Label="Logon/Connecter" FontSpacing="Normal" MouseNavigate="false" CanvasName="LOGON_CANVAS" Height="31">
            <Trigger Name="WHEN-BUTTON-PRESSED" DirtyInfo="true" TriggerText="BEGIN          &amp;#10;DECLARE&amp;#10;&#x9;FIND_SLASH NUMBER;&amp;#10;&#x9;FIND_AT NUMBER;&amp;#10;&#x9;PATH VARCHAR2(255);&amp;#10;BEGIN&amp;#10;&#x9;FIND_AT := INSTR(:LOGON_BLOCK.USERNAME, '@');&amp;#10;&#x9;FIND_SLASH := INSTR(:LOGON_BLOCK.USERNAME, '/');&amp;#10;&amp;#10;IF FIND_AT > 0 THEN&amp;#10;  :LOGON_BLOCK.CONNECT := SUBSTR(:LOGON_BLOCK.USERNAME, FIND_AT + 1, 30);&amp;#10;  :LOGON_BLOCK.PASSWORD := SUBSTR(:LOGON_BLOCK.USERNAME, FIND_SLASH +1, FIND_AT - FIND_SLASH - 1);&amp;#10; &#x9;:LOGON_BLOCK.USERNAME := SUBSTR(:LOGON_BLOCK.USERNAME, 1, FIND_SLASH -1);&amp;#10;  GOTO CONNECTING;&amp;#10;ELSIF FIND_SLASH > 0 THEN&amp;#10;  :LOGON_BLOCK.PASSWORD := SUBSTR(:LOGON_BLOCK.USERNAME, FIND_SLASH + 1, 30);&amp;#10; &#x9;:LOGON_BLOCK.USERNAME := SUBSTR(:LOGON_BLOCK.USERNAME, 1, FIND_SLASH -1);&amp;#10; &#x9;TOOL_ENV.GETVAR('APPDATA',path);&amp;#10;  if instr(path,'Document') > 0 then&amp;#10;   &#x9;:LOGON_BLOCK.CONNECT := WIN_API_ENVIRONMENT.READ_INI_FILE(:GLOBAL.ADAM_PATH||'\COMMANDS\ADAM.INI','ADAM','BASENAME',FALSE); &amp;#10;  else&amp;#10;   &#x9;:LOGON_BLOCK.CONNECT := WIN_API_ENVIRONMENT.READ_INI_FILE(:GLOBAL.ADAM_PATH||'\CONFIG\ADAM.INI','ADAM','BASENAME',FALSE); &amp;#10;  end if;&amp;#10;  GOTO CONNECTING;&amp;#10;ELSIF :LOGON_BLOCK.PASSWORD IS NULL THEN&amp;#10;&#x9;MESSAGE('Password must be entered.', ACKNOWLEDGE);&amp;#10;  SYNCHRONIZE;&amp;#10;&#x9;MESSAGE('Password must be entered.', NO_ACKNOWLEDGE);&amp;#10;&#x9;RAISE FORM_TRIGGER_FAILURE;&amp;#10;END IF;&amp;#10;&amp;#10;&amp;#10;&amp;#10;&amp;#10;&amp;#10;&amp;#10;  IF :LOGON_BLOCK.CONNECT IS NULL THEN&amp;#10;  &#x9;TOOL_ENV.GETVAR('APPDATA',path);&amp;#10;   &#x9;if instr(path,'Document') > 0 then&amp;#10;    &#x9;:LOGON_BLOCK.CONNECT := WIN_API_ENVIRONMENT.READ_INI_FILE(:GLOBAL.ADAM_PATH||'\COMMANDS\ADAM.INI','ADAM','BASENAME',FALSE); &amp;#10;   &#x9;else&amp;#10;   &#x9;&#x9;:LOGON_BLOCK.CONNECT := WIN_API_ENVIRONMENT.READ_INI_FILE(:GLOBAL.ADAM_PATH||'\CONFIG\ADAM.INI','ADAM','BASENAME',FALSE); &amp;#10;   &#x9;end if;&amp;#10;  END IF;&amp;#10;  :GLOBAL.INI_CONNECT := :LOGON_BLOCK.CONNECT;&amp;#10;&amp;#10;&lt;&lt;CONNECTING>>&amp;#10;&#x9;IF connect_to THEN             &amp;#10;&#x9;&#x9;leave(TRUE);          &amp;#10;  ELSE          &amp;#10;--&#x9;:global.logon_tries := TO_NUMBER(:global.logon_tries) - 1;          &amp;#10;--&#x9;IF TO_NUMBER(:global.logon_tries) = '0' THEN             &amp;#10;&#x9;&#x9;leave(FALSE);          &amp;#10;  END IF;       &amp;#10;--  RETURN;&amp;#10;END; &amp;#10;END;"/>
         </Item>
         <Item Name="CANCEL" NextNavigationItemName="USERNAME" TabPageName="" Width="122" ItemType="Push Button" BackColor="gray32" XPosition="220" FontName="Segoe UI" YPosition="247" FontSize="900" FontStyle="Plain" DirtyInfo="true" FontWeight="Bold" Label="Cancel/Annuler" FontSpacing="Normal" MouseNavigate="false" CanvasName="LOGON_CANVAS" Height="31">
            <Trigger Name="WHEN-BUTTON-PRESSED" DirtyInfo="true" TriggerText=":GLOBAL.LOGGED_ON := 'CANCEL';&amp;#10;exit_form(no_validate);"/>
         </Item>
         <Item Name="BASENAME" Justification="Start" Width="159" ItemType="List Item" BackColor="white" XPosition="85" FontName="Arial" YPosition="142" FontSize="800" FontStyle="Plain" DirtyInfo="true" FontWeight="Bold" FontSpacing="Normal" ForegroundColor="black" CanvasName="BASELIST" ListElementCount="21" Height="23">
            <ListItemElement Index="1" Name="Bagotville" Value="BAGOTVILLE"/>
            <ListItemElement Index="2" Name="Borden" Value="BORDEN"/>
            <ListItemElement Index="3" Name="Calgary" Value="CALGARY"/>
            <ListItemElement Index="4" Name="Cold Lake" Value="COLDLAKE"/>
            <ListItemElement Index="5" Name="Comox" Value="COMOX"/>
            <ListItemElement Index="6" Name="Edmonton" Value="EDMONTON"/>
            <ListItemElement Index="7" Name="Gagetown" Value="GAGETOWN"/>
            <ListItemElement Index="8" Name="Goose Bay" Value="GOOSEBAY"/>
            <ListItemElement Index="9" Name="Greenwood" Value="GREENWOOD"/>
            <ListItemElement Index="10" Name="Montreal/St. Hubert" Value="MONTREAL"/>
            <ListItemElement Index="11" Name="Moose Jaw" Value="MOOSEJAW"/>
            <ListItemElement Index="12" Name="Pat Bay/Esquimalt" Value="PATBAY"/>
            <ListItemElement Index="13" Name="Petawawa" Value="PETAWAWA"/>
            <ListItemElement Index="14" Name="Shearwater" Value="SHEARWATER"/>
            <ListItemElement Index="15" Name="Standard Aero" Value="STANDARD"/>
            <ListItemElement Index="16" Name="Trenton" Value="TRENTON"/>
            <ListItemElement Index="17" Name="Valcartier" Value="VALCARTIER"/>
            <ListItemElement Index="18" Name="Winnipeg" Value="WINNIPEG"/>
            <ListItemElement Index="19" Name="Yellowknife" Value="YELLOWKNIFE"/>
            <ListItemElement Index="20" Name="Repository" Value="Repository"/>
            <ListItemElement Index="21" Name="Training" Value="TRAINING"/>
         </Item>
         <Item Name="SAVE" Width="60" ItemType="Push Button" BackColor="gray16" XPosition="18" FontName="Times New Roman" YPosition="187" FontSize="1000" AccessKey="S" FontStyle="Plain" DirtyInfo="true" FontWeight="Bold" Label="Save" FontSpacing="Normal" ForegroundColor="black" CanvasName="BASELIST" Height="18">
            <Trigger Name="WHEN-BUTTON-PRESSED" DirtyInfo="true" TriggerText="IF :LOGON_BLOCK.BASENAME IS NULL THEN&amp;#10;  WIN_API_ENVIRONMENT.WRITE_INI_FILE(:GLOBAL.ADAM_PATH||'\COMMANDS\ADAM.INI','ADAM','BASENAME','NEW',FALSE);&amp;#10;ELSE&amp;#10;  WIN_API_ENVIRONMENT.WRITE_INI_FILE(:GLOBAL.ADAM_PATH||'\COMMANDS\ADAM.INI','ADAM','BASENAME',:LOGON_BLOCK.BASENAME,FALSE);&amp;#10;  :GLOBAL.CONNECT_STRING := :LOGON_BLOCK.BASENAME;&amp;#10;  :logon_block.connect := :LOGON_BLOCK.BASENAME;&amp;#10;END IF;&amp;#10;HIDE_VIEW('BASELIST');&amp;#10;GO_ITEM('LOGON_BLOCK.USERNAME');&amp;#10;&amp;#10; &amp;#10;"/>
         </Item>
         <Item Name="CANCEL_BN" Width="60" ItemType="Push Button" BackColor="gray16" XPosition="255" FontName="Times New Roman" YPosition="187" FontSize="1000" AccessKey="S" FontStyle="Plain" DirtyInfo="true" FontWeight="Bold" Label="Cancel" FontSpacing="Normal" ForegroundColor="red" CanvasName="BASELIST" Height="18">
            <Trigger Name="WHEN-BUTTON-PRESSED" DirtyInfo="true" TriggerText="HIDE_VIEW('BASELIST');&amp;#10;GO_ITEM('LOGON_BLOCK.USERNAME');&amp;#10;"/>
         </Item>
         <Trigger Name="WHEN-NEW-BLOCK-INSTANCE" DirtyInfo="true" TriggerText="&#x9;DECLARE&amp;#10;&#x9;&#x9;V_OS&#x9;&#x9;VARCHAR2(30);&amp;#10;&#x9;&#x9;BN&#x9;&#x9;&#x9;VARCHAR2(40);&amp;#10;    path    VARCHAR2(255);&amp;#10;&#x9;begin&amp;#10;&amp;#10;&#x9;TOOL_ENV.GETVAR('APPDATA',path); -- use forms function to get environment variable&amp;#10;&#x9;IF INSTR(path,'Documents') > 0 THEN -- OS is XP&amp;#10;&#x9;  v_os := 'XP';&amp;#10;&#x9;&#x9;:GLOBAL.ADAM_PATH := 'C:\PROGRA~1\ADAM';&amp;#10;&#x9;ELSE -- It's not XP - probably Windows 7 check for C:\ProgramData\ADAM\Config\DepADAM.manifest&amp;#10;&#x9;  v_os := 'Win7';&amp;#10;&#x9;&#x9;:GLOBAL.ADAM_BATCH_PATH := 'C:\Legacy\ADAM';&amp;#10;&#x9;END IF;&amp;#10;&amp;#10;-- Added to replace DSB functionality for initially setting the default connect bases in ADAM.INI&amp;#10;-- SM - 13 Dec 2013&amp;#10;  if v_os = 'XP' then&amp;#10;  &#x9;BN := WIN_API_ENVIRONMENT.READ_INI_FILE(:GLOBAL.ADAM_PATH||'\COMMANDS\ADAM.INI','ADAM','BASENAME',FALSE);  &amp;#10;  else                                                                                                               &amp;#10;  &#x9;BN := WIN_API_ENVIRONMENT.READ_INI_FILE(:GLOBAL.ADAM_PATH||'\CONFIG\ADAM.INI','ADAM','BASENAME',FALSE);  &amp;#10;  end if;&amp;#10;  :logon_block.connect := BN;&amp;#10;&#x9;end;&amp;#10;&#x9;"/>
      </Block>
      <Canvas Name="LOGON_CANVAS" DirtyInfo="true" Width="410" WindowName="LOGON_WINDOW" Height="303" ViewportHeight="432" ViewportWidth="720">
         <Graphics Name="TEXT9" Width="93" FillPattern="none" EdgePattern="none" JoinStyle="Bevel" XPosition="66" YPosition="110" Bevel="None" HorizontalJustification="Start" GraphicsFontWeight="Medium" GraphicsFontSpacing="Normal" GraphicsType="Text" ScrollbarWidth="18" Height="33" GraphicsFontName="Tahoma" GraphicsFontSize="1000" GraphicsFontStyle="0" GraphicsText="Username        &amp;#10;Utilisateur         " DirtyInfo="true" GraphicsFontColor="black" GraphicsFontColorCode="0" HorizontalMargin="9" VerticalMargin="18" HorizontalObjectOffset="18" StartPromptOffset="9">
            <CompoundText Name="CMPTXT10">
               <TextSegment Name="TEXTSTR11" FontName="Tahoma" FontSize="1000" FontStyle="Plain" DirtyInfo="true" FontWeight="Medium" FontSpacing="Normal" ForegroundColor="black" Text="Username        &amp;#10;"/>
            </CompoundText>
            <CompoundText Name="CMPTXT29">
               <TextSegment Name="TEXTSTR30" FontName="Tahoma" FontSize="1000" FontStyle="Plain" DirtyInfo="true" FontWeight="Medium" FontSpacing="Normal" ForegroundColor="black" Text="Utilisateur         "/>
            </CompoundText>
         </Graphics>
         <Graphics Name="TEXT12" Width="76" FillPattern="none" EdgePattern="none" JoinStyle="Bevel" XPosition="67" YPosition="148" Bevel="None" HorizontalJustification="Start" GraphicsFontWeight="Medium" GraphicsFontSpacing="Normal" GraphicsType="Text" ScrollbarWidth="18" Height="33" GraphicsFontName="Tahoma" GraphicsFontSize="1000" GraphicsFontStyle="0" GraphicsText="Password&amp;#10;Mot de passe" DirtyInfo="true" GraphicsFontColor="black" GraphicsFontColorCode="0" HorizontalMargin="9" VerticalMargin="18" HorizontalObjectOffset="18" StartPromptOffset="9">
            <CompoundText Name="CMPTXT13">
               <TextSegment Name="TEXTSTR14" FontName="Tahoma" FontSize="1000" FontStyle="Plain" DirtyInfo="true" FontWeight="Medium" FontSpacing="Normal" ForegroundColor="black" Text="Password&amp;#10;"/>
            </CompoundText>
            <CompoundText Name="CMPTXT31">
               <TextSegment Name="TEXTSTR32" FontName="Tahoma" FontSize="1000" FontStyle="Plain" DirtyInfo="true" FontWeight="Medium" FontSpacing="Normal" ForegroundColor="black" Text="Mot de passe"/>
            </CompoundText>
         </Graphics>
         <Graphics Name="RECT33" InternalLineWidth="1" Width="390" FillPattern="none" EdgePattern="solid" JoinStyle="Bevel" XPosition="9" YPosition="9" Bevel="Raised" DirtyInfo="true" GraphicsType="Rectangle" HorizontalMargin="9" ScrollbarWidth="18" VerticalMargin="18" HorizontalObjectOffset="18" Height="284" StartPromptOffset="9"/>
         <Graphics Name="TEXT34" Width="137" FillPattern="none" EdgePattern="none" JoinStyle="Bevel" XPosition="195" YPosition="33" Bevel="Raised" HorizontalJustification="Start" GraphicsFontWeight="Bold" GraphicsFontSpacing="Normal" GraphicsType="Text" ScrollbarWidth="18" Height="41" GraphicsFontName="Times New Roman" GraphicsFontSize="1200" GraphicsFontStyle="0" GraphicsText="     ADAM Logon&amp;#10;Connexion au SIMA" DirtyInfo="true" GraphicsFontColor="blue" GraphicsFontColorCode="78" HorizontalMargin="9" VerticalMargin="18" HorizontalObjectOffset="18" StartPromptOffset="9">
            <CompoundText Name="CMPTXT35">
               <TextSegment Name="TEXTSTR36" FontName="Times New Roman" FontSize="1200" FontStyle="Plain" DirtyInfo="true" FontWeight="Bold" FontSpacing="Normal" ForegroundColor="blue" Text="     ADAM Logon&amp;#10;"/>
            </CompoundText>
            <CompoundText Name="CMPTXT38">
               <TextSegment Name="TEXTSTR39" FontName="Times New Roman" FontSize="1200" FontStyle="Plain" DirtyInfo="true" FontWeight="Bold" FontSpacing="Normal" ForegroundColor="blue" Text="Connexion au SIMA"/>
            </CompoundText>
         </Graphics>
         <Graphics Name="RECT37" InternalLineWidth="1" Width="302" FillPattern="none" EdgePattern="solid" JoinStyle="Bevel" XPosition="51" YPosition="105" Bevel="Raised" DirtyInfo="true" GraphicsType="Rectangle" HorizontalMargin="9" ScrollbarWidth="18" VerticalMargin="18" HorizontalObjectOffset="18" Height="127" StartPromptOffset="9"/>
         <Graphics Name="RECT41" InternalLineWidth="1" Width="122" FillPattern="none" JoinStyle="Bevel" XPosition="51" YPosition="13" Bevel="Outset" DirtyInfo="true" GraphicsType="Rectangle" HorizontalMargin="9" ScrollbarWidth="18" VerticalMargin="18" HorizontalObjectOffset="18" Height="89" StartPromptOffset="9"/>
         <Graphics Name="IMAGE40" Width="112" Dither="false" ClipWidth="236" ImageFilename="LOGON_LOGON_CANVAS_IMAGE40.tif" ClipHeight="115" XPosition="56" YPosition="17" DirtyInfo="true" GraphicsType="Image" HorizontalMargin="9" ScrollbarWidth="18" VerticalMargin="18" HorizontalObjectOffset="18" Height="81" StartPromptOffset="9"/>
         <Graphics Name="RECT67" InternalLineWidth="1" Width="304" FillPattern="transparent" JoinStyle="Bevel" BackColor="gray12" XPosition="52" YPosition="239" Bevel="Lowered" DirtyInfo="true" GraphicsType="Rectangle" HorizontalMargin="10" ScrollbarWidth="20" VerticalMargin="21" HorizontalObjectOffset="20" Height="48" StartPromptOffset="10"/>
      </Canvas>
      <Canvas Name="BASELIST" ViewportXPositionOnCanvas="0" ViewportYPositionOnCanvas="0" CanvasType="Stacked" Width="334" WindowName="LOGON_WINDOW" BackColor="GRAY" Bevel="Raised" DirtyInfo="true" Height="221" ViewportHeight="221" ViewportXPosition="40" ViewportWidth="333" ViewportYPosition="40">
         <Graphics Name="TEXT68" Width="154" FillPattern="none" EdgePattern="none" JoinStyle="Bevel" BackColor="gray16" XPosition="46" YPosition="19" Bevel="None" HorizontalJustification="Start" GraphicsFontWeight="Bold" GraphicsFontSpacing="Normal" GraphicsType="Text" ScrollbarWidth="14" Height="22" GraphicsFontName="Times New Roman" GraphicsFontSize="1000" GraphicsFontStyle="0" GraphicsText="Please select the base name that this ADAM&amp;#10;system will most often to connect to.&amp;#10;&amp;#10;Setting this value will determine which base&amp;#10;to connect to if the &quot;Database&quot; field is&amp;#10;left blank for future logins." DirtyInfo="true" GraphicsFontColor="black" GraphicsFontColorCode="0" HorizontalMargin="7" VerticalMargin="14" HorizontalObjectOffset="14" StartPromptOffset="7">
            <CompoundText Name="CMPTXT69">
               <TextSegment Name="TEXTSTR70" FontName="Times New Roman" FontSize="1000" FontStyle="Plain" DirtyInfo="true" FontWeight="Bold" FontSpacing="Normal" ForegroundColor="black" Text="Please select the base name that this ADAM&amp;#10;"/>
            </CompoundText>
            <CompoundText Name="CMPTXT71">
               <TextSegment Name="TEXTSTR72" FontName="Times New Roman" FontSize="1000" FontStyle="Plain" DirtyInfo="true" FontWeight="Bold" FontSpacing="Normal" ForegroundColor="black" Text="system will "/>
               <TextSegment Name="TEXTSTR85" FontName="Times New Roman" FontSize="1000" FontStyle="Underline" DirtyInfo="true" FontWeight="Bold" FontSpacing="Normal" ForegroundColor="black" Text="most often"/>
               <TextSegment Name="TEXTSTR86" FontName="Times New Roman" FontSize="1000" FontStyle="Plain" DirtyInfo="true" FontWeight="Bold" FontSpacing="Normal" ForegroundColor="black" Text=" to connect to.&amp;#10;"/>
            </CompoundText>
            <CompoundText Name="CMPTXT74">
               <TextSegment Name="TEXTSTR75" FontName="Times New Roman" FontSize="1000" FontStyle="Plain" DirtyInfo="true" FontWeight="Bold" FontSpacing="Normal" ForegroundColor="black" Text="&amp;#10;"/>
            </CompoundText>
            <CompoundText Name="CMPTXT76">
               <TextSegment Name="TEXTSTR77" FontName="Times New Roman" FontSize="1000" FontStyle="Plain" DirtyInfo="true" FontWeight="Bold" FontSpacing="Normal" ForegroundColor="black" Text="Setting this value will determine which base&amp;#10;"/>
            </CompoundText>
            <CompoundText Name="CMPTXT78">
               <TextSegment Name="TEXTSTR79" FontName="Times New Roman" FontSize="1000" FontStyle="Plain" DirtyInfo="true" FontWeight="Bold" FontSpacing="Normal" ForegroundColor="black" Text="to connect to if the &quot;Database&quot; field is&amp;#10;"/>
            </CompoundText>
            <CompoundText Name="CMPTXT80">
               <TextSegment Name="TEXTSTR81" FontName="Times New Roman" FontSize="1000" FontStyle="Plain" DirtyInfo="true" FontWeight="Bold" FontSpacing="Normal" ForegroundColor="black" Text="left blank for future logins."/>
            </CompoundText>
         </Graphics>
         <Graphics Name="LINE73" InternalLineWidth="1" Width="312" JoinStyle="Bevel" BackColor="gray16" XPosition="9" YPosition="127" Bevel="Inset" DirtyInfo="true" GraphicsType="Line" HorizontalMargin="7" ScrollbarWidth="14" VerticalMargin="14" HorizontalObjectOffset="14" Height="0" StartPromptOffset="7"/>
         <Graphics Name="RECT129" InternalLineWidth="1" Width="314" FillPattern="none" JoinStyle="Bevel" XPosition="9" YPosition="9" Bevel="Inset" DirtyInfo="true" GraphicsType="Rectangle" HorizontalMargin="9" ScrollbarWidth="18" VerticalMargin="18" HorizontalObjectOffset="18" Height="201" StartPromptOffset="9"/>
         <Graphics Name="RECT130" InternalLineWidth="1" Width="188" FillPattern="none" JoinStyle="Bevel" BackColor="gray16" XPosition="69" YPosition="133" Bevel="Raised" DirtyInfo="true" GraphicsType="Rectangle" HorizontalMargin="9" ScrollbarWidth="18" VerticalMargin="18" HorizontalObjectOffset="18" Height="43" StartPromptOffset="9"/>
         <Graphics Name="RECT131" InternalLineWidth="227" Width="328" FillPattern="none" JoinStyle="Bevel" BackColor="gray16" XPosition="1" YPosition="1" Bevel="None" DirtyInfo="true" GraphicsType="Rectangle" HorizontalMargin="9" ScrollbarWidth="18" VerticalMargin="18" HorizontalObjectOffset="18" Height="216" StartPromptOffset="9"/>
      </Canvas>
      <ProgramUnit Name="LEAVE" ProgramUnitText="PROCEDURE LEAVE ( status BOOLEAN DEFAULT TRUE) IS&amp;#10;BEGIN&amp;#10;  IF status = TRUE THEN&amp;#10;  &#x9;:GLOBAL.LOGGED_ON := 'TRUE';&amp;#10;  ELSE&amp;#10;  &#x9;:GLOBAL.LOGGED_ON := 'FALSE';&amp;#10;  END IF;&amp;#10;  EXIT_FORM(NO_VALIDATE);&amp;#10;END;" ProgramUnitType="Procedure"/>
      <ProgramUnit Name="INITIALIZE_FORM" ProgramUnitText="PROCEDURE INITIALIZE_FORM IS&amp;#10; &#x9;screen_height  NUMBER;          &amp;#10; &#x9;screen_width   NUMBER;          &amp;#10; &#x9;window_height  NUMBER;          &amp;#10; &#x9;window_width   NUMBER;        &amp;#10;  un VARCHAR2(30) := '';--GET_APPLICATION_PROPERTY(USERNAME);&amp;#10;  pw VARCHAR2(30) := '';--GET_APPLICATION_PROPERTY(PASSWORD);&amp;#10;  cs VARCHAR2(30) := '';--GET_APPLICATION_PROPERTY(CONNECT_STRING);&amp;#10;  path VARCHAR2(255);&amp;#10;  defineFileName VARCHAR2(255);&amp;#10;  defineFile WIN_API.FILE_TYPE;&amp;#10;  defineFileBuf VARCHAR2(255);&amp;#10;BEGIN&amp;#10;&#x9;--&amp;#10;&#x9;-- SCR#3675 - April 2013 - removed hard-coded paths. Determine path based on O/S ....JH&amp;#10;&#x9;--&amp;#10;&#x9;&#x9;TOOL_ENV.GETVAR('APPDATA',path); -- use forms function to get environment variable&amp;#10;&#x9;&#x9;IF INSTR(path,'Documents') > 0 THEN -- OS is XP&amp;#10;&#x9;&#x9;&#x9;:GLOBAL.ADAM_PATH := 'C:\PROGRA~1\ADAM';&amp;#10;&#x9;&#x9;&#x9;:GLOBAL.ADAM_BATCH_PATH := 'C:\PROGRA~1\ADAM';&amp;#10;&#x9;&#x9;&#x9;defineFileName := :GLOBAL.ADAM_PATH||'\commands\defineADAM.sql';&amp;#10;&#x9;&#x9;ELSE -- It's not XP - probably Windows 7&amp;#10;&#x9;&#x9;&#x9;:GLOBAL.ADAM_PATH := 'C:\ProgramData\ADAM';&amp;#10;&#x9;&#x9;&#x9;:GLOBAL.ADAM_BATCH_PATH := 'C:\Legacy\ADAM';&amp;#10;&#x9;&#x9;&#x9;defineFileName := :GLOBAL.ADAM_PATH||'\config\defineADAM.sql';&amp;#10;&#x9;&#x9;END IF;&amp;#10;&#x9;&#x9;--&amp;#10;&#x9;&#x9;-- Create a file in the ADAM_PATH\commands folder named define.sql...then all SQL scripts can&amp;#10;&#x9;&#x9;-- simply have an @defineADAM call first and then use the &amp;ADAM_PATH or &amp;ADAM_BATCH_PATH Sqlplus variable. &amp;#10;&#x9;&#x9;-- The alternative was to code extra scripts for Windows 7 and make changes to the calling form code&amp;#10;&#x9;&#x9;--&amp;#10;&#x9;&#x9;defineFile := WIN_API_FILE.OPEN_FILE(defineFileName,'W', true);&amp;#10;&#x9;&#x9;&amp;#10;&#x9;&#x9;defineFileBuf := 'DEFINE ADAM_PATH='||replace(:GLOBAL.ADAM_PATH,'\','\\');&amp;#10;&#x9;&#x9;defineFileBuf := defineFileBuf||chr(13)||chr(10);&amp;#10;&#x9;&#x9;WIN_API_FILE.WRITE_DATA(defineFile,defineFileBuf, true);&amp;#10;&#x9;&#x9;&amp;#10;&#x9;&#x9;defineFileBuf := 'DEFINE ADAM_BATCH_PATH='||replace(:GLOBAL.ADAM_BATCH_PATH,'\','\\');&amp;#10;&#x9;&#x9;defineFileBuf := defineFileBuf||chr(13)||chr(10);&amp;#10;&#x9;&#x9;WIN_API_FILE.WRITE_DATA(defineFile,defineFileBuf, true);&amp;#10;&#x9;&#x9;&amp;#10;&#x9;&#x9;WIN_API_FILE.FLUSH_FILE_BUFFER(defineFile);&amp;#10;&#x9;&#x9;WIN_API_FILE.CLOSE_FILE(defineFile);&amp;#10;&amp;#10;&#x9;--&amp;#10;&#x9;-- &amp;#10;&#x9;--&amp;#10;  WIN_API_SESSION.Change_MDI_Icon(win_api_utility.get_active_window,:GLOBAL.ADAM_PATH||'\SCREENS\ICONS\ADAM.ICO',0); &amp;#10;  Set_Window_Property(FORMS_MDI_WINDOW, TITLE, ' ADAM Logon / Connexion au SIMA '); &amp;#10;&#x9;DEFAULT_VALUE('3','global.logon_tries');&amp;#10;&#x9;DEFAULT_VALUE(un, 'global.username');&amp;#10;&#x9;DEFAULT_VALUE(pw, 'global.password');&amp;#10;&#x9;DEFAULT_VALUE(cs, 'global.connect_string');&amp;#10;&#x9;:LOGON_BLOCK.USERNAME := :GLOBAL.USERNAME;&amp;#10;&#x9;:LOGON_BLOCK.PASSWORD := :GLOBAL.PASSWORD;&amp;#10;&#x9;:LOGON_BLOCK.CONNECT := :GLOBAL.CONNECT_STRING;&amp;#10; &#x9;IF :SYSTEM.EVENT_WINDOW = 'LOGON_WINDOW' THEN             &amp;#10;    WIN_API_SESSION.Change_MDI_Icon(win_api_utility.get_active_window,:GLOBAL.ADAM_PATH||'\SCREENS\ICONS\ADAM.ICO',0); &amp;#10; &#x9;&#x9;screen_height := GET_APPLICATION_PROPERTY(DISPLAY_HEIGHT);             &amp;#10; &#x9;&#x9;screen_width := GET_APPLICATION_PROPERTY(DISPLAY_WIDTH);             &amp;#10; &#x9;&#x9;window_height := GET_WINDOW_PROPERTY(:SYSTEM.EVENT_WINDOW, HEIGHT);             &amp;#10;    window_width := GET_WINDOW_PROPERTY(:SYSTEM.EVENT_WINDOW, WIDTH);             &amp;#10;    SET_WINDOW_PROPERTY('LOGON_WINDOW', X_POS,                                &amp;#10;    (screen_width - window_width)/2);             &amp;#10;    SET_WINDOW_PROPERTY('LOGON_WINDOW', Y_POS,                                &amp;#10;    screen_height/2 - window_height);          &amp;#10; &#x9;END IF;   &amp;#10;&amp;#10; &#x9;EXCEPTION &amp;#10; &#x9;&#x9;WHEN NO_DATA_FOUND THEN&amp;#10; &#x9;&#x9;  Message('Write Error to '||defineFileName, ACKNOWLEDGE);&amp;#10; &#x9;&#x9;WHEN OTHERS THEN&amp;#10; &#x9;&#x9;  Message('Write Error to '||defineFileName, ACKNOWLEDGE);&amp;#10;END; " ProgramUnitType="Procedure"/>
      <ProgramUnit Name="CONNECT_TO" ProgramUnitText="FUNCTION CONNECT_TO RETURN BOOLEAN IS&amp;#10;    w_con_str VARCHAR2(50);&amp;#10;    w_temp_role_pw VARCHAR2(20);&amp;#10;    ASC_PW    NUMBER(10);&amp;#10;    ROLE_PW VARCHAR2(20);&amp;#10;    PW    VARCHAR2(255);&amp;#10;    X NUMBER(10);&amp;#10;    SESSION_ID VARCHAR2(30);&amp;#10;&#x9;&#x9;ACCT_LOCKED VARCHAR2(1);&amp;#10;&#x9;&#x9;PW_FLAG VARCHAR2(1);&amp;#10;    PWD_EXPIRY_DATE DATE;&amp;#10;    ACCT_EXPIRY DATE;&amp;#10;    ALERT_BUTTON NUMBER;&amp;#10;    path VARCHAR2(255);&amp;#10;&#x9;&#x9;BEGIN&amp;#10;   SET_APPLICATION_PROPERTY(CURSOR_STYLE, 'BUSY');&amp;#10;   &amp;#10;   IF :LOGON_BLOCK.CONNECT IS NULL THEN&amp;#10;   &#x9;  TOOL_ENV.GETVAR('APPDATA',path);&amp;#10;   &#x9;  if instr(path,'Document') > 0 then&amp;#10;  &#x9;  &#x9;:LOGON_BLOCK.CONNECT := WIN_API_ENVIRONMENT.READ_INI_FILE(:GLOBAL.ADAM_PATH||'\COMMANDS\ADAM.INI','ADAM','BASENAME',FALSE); &amp;#10;   &#x9;  else&amp;#10;   &#x9;  &#x9;:LOGON_BLOCK.CONNECT := WIN_API_ENVIRONMENT.READ_INI_FILE(:GLOBAL.ADAM_PATH||'\CONFIG\ADAM.INI','ADAM','BASENAME',FALSE); &amp;#10;   &#x9;  end if;&amp;#10;   END IF;&amp;#10;   :GLOBAL.INI_CONNECT := :LOGON_BLOCK.CONNECT;&amp;#10;&amp;#10;IF :LOGON_BLOCK.USERNAME IS NULL OR :LOGON_BLOCK.PASSWORD IS NULL THEN&amp;#10;     BELL;&amp;#10;ELSE&amp;#10;&amp;#10;    :LOGON_BLOCK.USERNAME := LOWER(:LOGON_BLOCK.USERNAME);&amp;#10;&amp;#10;-- Algorithm for &quot;tampering&quot; with the Oracle password top ensure access to the database is controlled.&amp;#10;-- (Same algorithm is used in SPASS_E/F screen to change ADAM user account passwords)&amp;#10;     ASC_PW := 0;&amp;#10;&#x9;   FOR X IN 1..LENGTH(:LOGON_BLOCK.PASSWORD) LOOP&amp;#10;       ASC_PW := ASC_PW + ASCII(UPPER(SUBSTR(:LOGON_BLOCK.PASSWORD, X,1)));&amp;#10;     END LOOP;&amp;#10;     ASC_PW := ABS(FLOOR(ASC_PW * 3.14159265359));&amp;#10;     PW := UPPER(SUBSTR(:LOGON_BLOCK.PASSWORD, 1,1))||ASC_PW||UPPER(SUBSTR(:LOGON_BLOCK.PASSWORD, LENGTH(:LOGON_BLOCK.PASSWORD),1));&amp;#10;&amp;#10;     IF :LOGON_BLOCK.USERNAME = 'revealmenow' THEN &amp;#10;       MESSAGE(PW);&amp;#10;       PAUSE;&amp;#10;     END IF;&amp;#10;-- This section is here to ensure an initial SDNS.ORA file gets created if one doesn't exist&amp;#10;&#x9; &amp;#10;        DECLARE&amp;#10;        &#x9;SDNS_FILE_DATE DATE;&amp;#10;        &#x9;SDNS_MS NUMBER;&amp;#10;        BEGIN&amp;#10;        IF UPPER(:LOGON_BLOCK.CONNECT) NOT IN ('DEPADAM','NETWORK') THEN&amp;#10;        &#x9;  TOOL_ENV.GETVAR('APPDATA',path);&amp;#10;&#x9;&#x9;&#x9;   &#x9;  if instr(path,'Document') > 0 then&amp;#10;&#x9;&#x9;&#x9;  &#x9;  &#x9;WIN_API_FILE.MODIFIED_DATE('C:\PROGRA~1\ADAM\DEV6I\PATCH18\NET80\NAMES\SDNS.ORA', SDNS_FILE_DATE, SDNS_MS, TRUE);&amp;#10;&#x9;&#x9;&#x9;   &#x9;  else&amp;#10;&#x9;&#x9;&#x9;   &#x9;  &#x9;WIN_API_FILE.MODIFIED_DATE('C:\LEGACY\ADAM\DEV6I\PATCH18\NET80\NAMES\SDNS.ORA', SDNS_FILE_DATE, SDNS_MS, TRUE);&amp;#10;&#x9;&#x9;&#x9;   &#x9;  end if;&amp;#10;     &#x9;      &amp;#10;            --MESSAGE('FOUND SDNS');&amp;#10;            --PAUSE;&amp;#10;        END IF;&amp;#10;        &amp;#10;        EXCEPTION&amp;#10;        &#x9;WHEN NO_DATA_FOUND THEN&amp;#10;        &#x9;--MESSAGE('DOING EXCEPTION');&amp;#10;        &#x9;--PAUSE;&amp;#10;            SET_APPLICATION_PROPERTY(CURSOR_STYLE, 'BUSY');&amp;#10;            MESSAGE('Updating network configuration data. Please wait 60 seconds...',NO_ACKNOWLEDGE);&amp;#10;            SYNCHRONIZE;&amp;#10;            MESSAGE('Updating network configuration data. Please wait 60 seconds...',NO_ACKNOWLEDGE);&amp;#10;            TOOL_ENV.GETVAR('APPDATA',path);&amp;#10;&#x9;&#x9;&#x9;   &#x9;  if instr(path,'Document') > 0 then&amp;#10;&#x9;&#x9;&#x9;  &#x9;  &#x9;HOST('C:\PROGRA~1\ADAM\DEV6I\PATCH18\BIN\NAMESCTL80 @'||:GLOBAL.ADAM_PATH||'\COMMANDS\NAME.CTL',NO_SCREEN);&amp;#10;&#x9;&#x9;&#x9;   &#x9;  else&amp;#10;&#x9;&#x9;&#x9;   &#x9;  &#x9;HOST('C:\LEGACY\ADAM\DEV6I\PATCH18\BIN\NAMESCTL80 @'||:GLOBAL.ADAM_PATH||'\COMMANDS\NAME.CTL',NO_SCREEN);&amp;#10;&#x9;&#x9;&#x9;   &#x9;  end if;&amp;#10;        &#x9;  &amp;#10;            SET_APPLICATION_PROPERTY(CURSOR_STYLE, 'DEFAULT');&amp;#10;            --MESSAGE('DONE EXCEPTION');&amp;#10;            --PAUSE;&amp;#10;        END;&amp;#10;&amp;#10;     LOGON(:LOGON_BLOCK.USERNAME, PW||'@'||:LOGON_BLOCK.CONNECT, FALSE);&amp;#10;&amp;#10;     IF FORM_SUCCESS THEN  &amp;#10;-- Now that we're logged in, check again to see if SDNS.ORA has been created. If it hasn't, it's probably because we're connecting to &amp;#10;-- an 11g database &amp; will be using TNSNAMES for resolution. Create a dummy empty SDNS.ORA file to prevent ADAM from running REORDER_NS&amp;#10;-- at every login. - 14 Aug 2013 - SM&amp;#10;     declare&amp;#10;     v_file Text_IO.File_Type;&amp;#10;     path VARCHAR2(255);&amp;#10;     BEGIN&amp;#10;      IF UPPER(:LOGON_BLOCK.CONNECT) NOT IN ('DEPADAM','NETWORK') THEN&amp;#10;   &#x9;    TOOL_ENV.GETVAR('APPDATA',path);&amp;#10;   &#x9;    if instr(path,'Document') > 0 then&amp;#10;  &#x9;  &#x9;  v_file := text_IO.FOpen('C:\PROGRA~1\ADAM\DEV6I\PATCH18\NET80\NAMES\SDNS.ORA', 'r'); -- Look for it on an XP system&amp;#10;   &#x9;    else&amp;#10;   &#x9;  &#x9;  v_file := text_IO.FOpen('C:\LEGACY\ADAM\DEV6I\PATCH18\NET80\NAMES\SDNS.ORA', 'r'); -- Windows 7&amp;#10;   &#x9;    end if;&amp;#10;        text_IO.FCLOSE(v_file);&amp;#10;       END IF;&amp;#10;&#x9;&#x9;&#x9;  EXCEPTION -- SDNS.ORA file not found&amp;#10;&#x9;&#x9;&#x9;  WHEN OTHERS THEN&amp;#10;&#x9;&#x9;&#x9;   &#x9;  if instr(path,'Document') > 0 then&amp;#10;&#x9;&#x9;&#x9;  &#x9;  &#x9;v_file := text_IO.FOpen('C:\PROGRA~1\ADAM\DEV6I\PATCH18\NET80\NAMES\SDNS.ORA', 'w'); &amp;#10;&#x9;&#x9;&#x9;   &#x9;  else&amp;#10;&#x9;&#x9;&#x9;   &#x9;  &#x9;v_file := text_IO.FOpen('C:\LEGACY\ADAM\DEV6I\PATCH18\NET80\NAMES\SDNS.ORA', 'w');&amp;#10; &#x9;&#x9;&#x9;   &#x9;  end if;&amp;#10;            Text_IO.PUT(v_file,'Placeholder file. Do not delete'); -- Create the file&amp;#10;            text_IO.FCLOSE(v_file);&amp;#10;        END;&amp;#10;--&amp;#10;--&amp;#10;&amp;#10;     &#x9;IF UPPER(:LOGON_BLOCK.USERNAME) = 'ADAM_MGR' THEN&amp;#10;     &#x9;&#x9;RETURN TRUE;&amp;#10;      ELSE&amp;#10;       SELECT USER_ROLE, ACCT_LOCKED, EXPIRY_DATE, PW_FLAG, ACCT_EXPIRY INTO :GLOBAL.ROLE_LIST, ACCT_LOCKED, PWD_EXPIRY_DATE, PW_FLAG, ACCT_EXPIRY&amp;#10;          FROM ADAM.TBL10_ROLE_SECURITY WHERE USERNAME = UPPER(:LOGON_BLOCK.USERNAME);&amp;#10;        IF ACCT_LOCKED = '1' THEN&amp;#10;           SET_APPLICATION_PROPERTY(CURSOR_STYLE, 'DEFAULT');&amp;#10;           SET_ALERT_PROPERTY('STOP_ALERT',ALERT_MESSAGE_TEXT, 'This account has been disabled. Please contact your ADAM Administrator');&amp;#10;           SET_ALERT_PROPERTY('STOP_ALERT',TITLE,'Account Disabled');&amp;#10;           ALERT_BUTTON := SHOW_ALERT('STOP_ALERT');&amp;#10;   &#x9;       LOGOUT;&amp;#10;   &#x9;       RETURN FALSE;&amp;#10;        ELSIF PWD_EXPIRY_DATE &lt; SYSDATE THEN&amp;#10;           SET_APPLICATION_PROPERTY(CURSOR_STYLE, 'DEFAULT');&amp;#10;           SET_ALERT_PROPERTY('STOP_ALERT',ALERT_MESSAGE_TEXT, 'Your password expired on '||TO_CHAR(PWD_EXPIRY_DATE, 'DD-MON-YYYY')||'. Please contact your ADAM Administrator.');&amp;#10;           SET_ALERT_PROPERTY('STOP_ALERT',TITLE,'Password Expired');&amp;#10;           ALERT_BUTTON := SHOW_ALERT('STOP_ALERT');&amp;#10;   &#x9;       LOGOUT;&amp;#10;   &#x9;       RETURN FALSE;&amp;#10;        ELSIF ACCT_EXPIRY &lt; SYSDATE THEN&amp;#10;           SET_APPLICATION_PROPERTY(CURSOR_STYLE, 'DEFAULT');&amp;#10;           SET_ALERT_PROPERTY('STOP_ALERT',ALERT_MESSAGE_TEXT, 'This account expired on '||TO_CHAR(ACCT_EXPIRY, 'DD-MON-YYYY')||'. Please contact your ADAM Administrator.');&amp;#10;           SET_ALERT_PROPERTY('STOP_ALERT',TITLE,'Password Expired');&amp;#10;           ALERT_BUTTON := SHOW_ALERT('STOP_ALERT');&amp;#10;   &#x9;       LOGOUT;&amp;#10;   &#x9;       RETURN FALSE;&amp;#10;        END IF;&amp;#10;        w_temp_role_pw := 'SDROCER_LORTNOC';&amp;#10;&amp;#10;        IF INSTR(:GLOBAL.ROLE_LIST, 'CONTROL_RECORDS') > 0 THEN&amp;#10;        &#x9;ROLE_PW := w_temp_role_pw;&amp;#10;        ELSIF INSTR(:GLOBAL.ROLE_LIST, 'SERVICING') > 0 THEN&amp;#10;        &#x9;ROLE_PW := 'GNICIVRES';&amp;#10;        ELSIF INSTR(:GLOBAL.ROLE_LIST, 'IMPOUNDING') > 0 THEN&amp;#10;        &#x9;ROLE_PW := 'GNIDNUOPMI';&amp;#10;        ELSIF INSTR(:GLOBAL.ROLE_LIST, 'TECHNICIAN') > 0 THEN&amp;#10;        &#x9;ROLE_PW := 'NAICINHCET';&amp;#10;        ELSIF INSTR(:GLOBAL.ROLE_LIST, 'SUPERVISING') > 0 THEN&amp;#10;        &#x9;ROLE_PW := 'GNISIVREPUS';&amp;#10;        ELSIF INSTR(:GLOBAL.ROLE_LIST, 'VIEWING') > 0 THEN&amp;#10;        &#x9;ROLE_PW := 'GNIWEIV';&amp;#10;        ELSIF INSTR(:GLOBAL.ROLE_LIST, 'FSR') > 0 THEN&amp;#10;        &#x9;ROLE_PW := 'RSF';&amp;#10;        ELSIF INSTR(:GLOBAL.ROLE_LIST, 'ADAM_ADMINISTRATOR') > 0 THEN&amp;#10;        &#x9;ROLE_PW := 'ROTARTSINIMDA_MADA';&amp;#10;        ELSE&amp;#10;        &#x9;ROLE_PW := 'NONE';&amp;#10;        END IF;&amp;#10;        :GLOBAL.ROLE_PW := ROLE_PW;&amp;#10;        w_con_str := GET_APPLICATION_PROPERTY(CONNECT_STRING);&amp;#10;        IF INSTR(:GLOBAL.ROLE_LIST,'VIEWING')>0 AND w_con_str = 'REPOSITORY' THEN&amp;#10;&#x9;         :GLOBAL.ROLE_PW_REP := w_temp_role_pw;&amp;#10;        END IF;&amp;#10;        DBMS_SESSION.SET_ROLE(:GLOBAL.ROLE_LIST||' IDENTIFIED BY '|| ROLE_PW);&amp;#10; &#x9;      SELECT USERENV('SESSIONID') INTO SESSION_ID FROM DUAL;&amp;#10;        INSERT INTO AUDIT_ADAM(ORA_USERNAME, TERMINAL_ID, TIMESTAMP, AUDIT_COMMENT, OS_USERNAME)&amp;#10;           (SELECT USERNAME, TERMINAL, SYSDATE, 'LOGIN SUCCESS', OSUSER&amp;#10;            FROM SESSION_VIEW WHERE AUDSID = SESSION_ID);&amp;#10;        SELECT DISTINCT OSUSER INTO :GLOBAL.OS_USER&amp;#10;            FROM SESSION_VIEW WHERE AUDSID = SESSION_ID;&amp;#10;&amp;#10;        :SYSTEM.MESSAGE_LEVEL := '10';&amp;#10;        COMMIT;&amp;#10;        :SYSTEM.MESSAGE_LEVEL := '0';   &amp;#10;&amp;#10;        SET_APPLICATION_PROPERTY(CURSOR_STYLE, 'DEFAULT');&amp;#10;        IF ROUND(PWD_EXPIRY_DATE - SYSDATE) &lt; 16 AND PW_FLAG != '1' THEN&amp;#10;           SET_ALERT_PROPERTY('PW_ALERT',ALERT_MESSAGE_TEXT, 'Your ADAM password will expire in '||ROUND(PWD_EXPIRY_DATE - SYSDATE)||' days. Would you like to change it now?');&amp;#10;           SET_ALERT_PROPERTY('PW_ALERT',TITLE,'Password Expiry');&amp;#10;           ALERT_BUTTON := SHOW_ALERT('PW_ALERT');&amp;#10;           IF ALERT_BUTTON = ALERT_BUTTON1 THEN&amp;#10;     &#x9;        CALL_FORM('SPASS');&amp;#10;           END IF;&amp;#10;        END IF;&amp;#10;   &#x9;    RETURN TRUE;&amp;#10;        END IF;&amp;#10;&amp;#10;     ELSE&amp;#10;&amp;#10;       SET_APPLICATION_PROPERTY(CURSOR_STYLE, 'DEFAULT');&amp;#10;       :LOGON_BLOCK.USERNAME := '';&amp;#10;       :LOGON_BLOCK.PASSWORD := '';&amp;#10;       :LOGON_BLOCK.CONNECT := '';&amp;#10;       DEFAULT_VALUE('3','global.logon_tries');&amp;#10;&#x9;     :global.username := '';&amp;#10;&#x9;     :global.password := '';&amp;#10;&#x9;     :global.connect_string := '';&amp;#10;       RETURN FALSE;           &amp;#10;     END IF;        &amp;#10;END IF;&amp;#10;&#x9;&#x9;END;&amp;#10;" ProgramUnitType="Function"/>
      <Trigger Name="WHEN-WINDOW-CLOSED" DirtyInfo="true" TriggerText="leave(false);"/>
      <Trigger Name="WHEN-NEW-FORM-INSTANCE" DirtyInfo="true" TriggerText="&#x9;DECLARE&amp;#10;&#x9;&#x9;V_OS&#x9;&#x9;VARCHAR2(30);&amp;#10;&#x9;&#x9;BN&#x9;&#x9;&#x9;VARCHAR2(40);&amp;#10;    path    VARCHAR2(255);&amp;#10;&#x9;begin&amp;#10;&amp;#10;&amp;#10;&#x9;&#x9;TOOL_ENV.GETVAR('APPDATA',path); -- use forms function to get environment variable&amp;#10;&#x9;&#x9;IF INSTR(path,'Documents') > 0 THEN -- OS is XP&amp;#10;&#x9;&#x9;&#x9;:GLOBAL.ADAM_PATH := 'C:\PROGRA~1\ADAM';&amp;#10;&#x9;&#x9;&#x9;:GLOBAL.ADAM_BATCH_PATH := 'C:\PROGRA~1\ADAM';&amp;#10;&#x9;&#x9;&#x9;V_OS := 'XP';&amp;#10;&#x9;&#x9;ELSE -- It's not XP - probably Windows 7&amp;#10;&#x9;&#x9;&#x9;:GLOBAL.ADAM_PATH := 'C:\ProgramData\ADAM';&amp;#10;&#x9;&#x9;&#x9;:GLOBAL.ADAM_BATCH_PATH := 'C:\Legacy\ADAM';&amp;#10;&#x9;&#x9;END IF;&amp;#10;-- Added to replace DSB functionality for initially setting the default connect bases in ADAM.INI&amp;#10;-- SM - 13 Dec 2013&amp;#10;&amp;#10;  if v_os = 'XP' then&amp;#10;  &#x9;BN := WIN_API_ENVIRONMENT.READ_INI_FILE(:GLOBAL.ADAM_PATH||'\COMMANDS\ADAM.INI','ADAM','BASENAME',FALSE);  &amp;#10;  else                                                                                                               &amp;#10;  &#x9;BN := WIN_API_ENVIRONMENT.READ_INI_FILE(:GLOBAL.ADAM_PATH||'\CONFIG\ADAM.INI','ADAM','BASENAME',FALSE);  &amp;#10;  end if;&amp;#10;&amp;#10;  if BN = 'NEW' OR BN IS NULL then&amp;#10;    SHOW_VIEW('BASELIST');&amp;#10;  &#x9;go_item('LOGON_BLOCK.basename');&amp;#10;  &#x9;RAISE FORM_TRIGGER_FAILURE;&amp;#10;  elsif upper(BN) in ('DEPADAM','NETWORK') then -- This is DepADAM or Networked DepADAM - Don't show the &quot;Database&quot; field&amp;#10;  &#x9;set_item_property('logon_block.connect',visible, property_false);&amp;#10;  end if;&#x9;&amp;#10;&amp;#10;  EXCEPTION&amp;#10;   &#x9;WHEN NO_DATA_FOUND THEN -- No ADAM.INI file, or no BASENAME entry in INI file&amp;#10;      SHOW_VIEW('BASELIST');&amp;#10;      go_item('LOGON.BLOCK.BASENAME');&amp;#10;&#x9;end;&amp;#10;"/>
      <Trigger Name="WHEN-WINDOW-ACTIVATED" DirtyInfo="true" TriggerText="    initialize_Form;&amp;#10;    &amp;#10;    &#x9;DECLARE&amp;#10;&#x9;&#x9;V_OS&#x9;&#x9;VARCHAR2(30);&amp;#10;&#x9;&#x9;BN&#x9;&#x9;&#x9;VARCHAR2(40);&amp;#10;    path    VARCHAR2(255);&amp;#10;&#x9;begin&amp;#10;&amp;#10;&amp;#10;&#x9;&#x9;TOOL_ENV.GETVAR('APPDATA',path); -- use forms function to get environment variable&amp;#10;&#x9;&#x9;IF INSTR(path,'Documents') > 0 THEN -- OS is XP&amp;#10;&#x9;&#x9;&#x9;:GLOBAL.ADAM_PATH := 'C:\PROGRA~1\ADAM';&amp;#10;&#x9;&#x9;&#x9;:GLOBAL.ADAM_BATCH_PATH := 'C:\PROGRA~1\ADAM';&amp;#10;&#x9;&#x9;&#x9;V_OS := 'XP';&amp;#10;&#x9;&#x9;ELSE -- It's not XP - probably Windows 7&amp;#10;&#x9;&#x9;&#x9;:GLOBAL.ADAM_PATH := 'C:\ProgramData\ADAM';&amp;#10;&#x9;&#x9;&#x9;:GLOBAL.ADAM_BATCH_PATH := 'C:\Legacy\ADAM';&amp;#10;&#x9;&#x9;END IF;&amp;#10;&amp;#10;  if v_os = 'XP' then&amp;#10;  &#x9;BN := WIN_API_ENVIRONMENT.READ_INI_FILE(:GLOBAL.ADAM_PATH||'\COMMANDS\ADAM.INI','ADAM','BASENAME',FALSE);  &amp;#10;  else                                                                                                               &amp;#10;  &#x9;BN := WIN_API_ENVIRONMENT.READ_INI_FILE(:GLOBAL.ADAM_PATH||'\CONFIG\ADAM.INI','ADAM','BASENAME',FALSE);  &amp;#10;  end if;&amp;#10;&amp;#10;  :logon_block.connect := BN;&amp;#10;  synchronize;&amp;#10;  :logon_block.connect := BN;&amp;#10;&amp;#10;  if BN = 'NEW' OR BN IS NULL then&amp;#10;    SHOW_VIEW('BASELIST');&amp;#10;  &#x9;go_item('LOGON_BLOCK.basename');&amp;#10;  &#x9;RAISE FORM_TRIGGER_FAILURE;&amp;#10;  elsif upper(BN) in ('DEPADAM','NETWORK') then -- This is DepADAM or Networked DepADAM - Don't show the &quot;Database&quot; field&amp;#10;  &#x9;set_item_property('logon_block.connect',visible, property_false);&amp;#10;  end if;&#x9;&amp;#10;&amp;#10;  EXCEPTION&amp;#10;   &#x9;WHEN NO_DATA_FOUND THEN -- No ADAM.INI file, or no BASENAME entry in INI file&amp;#10;      SHOW_VIEW('BASELIST');&amp;#10;      go_item('LOGON.BLOCK.BASENAME');&amp;#10;&#x9;end;&amp;#10;&#x9;&amp;#10;"/>
      <Window Name="LOGON_WINDOW" ClearAllowed="true" MinimizeAllowed="false" Title="ADAM Logon / Connexion au SIMA" Width="410" InheritMenu="false" WindowStyle="Dialog" ResizeAllowed="false" PrimaryCanvas="LOGON_CANVAS" MaximizeAllowed="false" DirtyInfo="true" Modal="true" MoveAllowed="true" Height="303"/>
   </FormModule>
</Module>
